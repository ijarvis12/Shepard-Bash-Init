#!/usr/bin/env bash

SOURCES="$(ls -1 /etc/shepard)"

for source in "$SOURCES"; do
  herd start "$source"
done

function stop() {
  SOURCES="$(ls -1 /etc/shepard)"
  for source in "$SOURCES"; do
    herd stop "$source"
  done
}

function shutdown() {
  stop
}

trap stop SIGSTOP
trap shutdown SIGPWR

while true; do
   sleep 1
done
